# üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –°–ò–°–¢–ï–ú–´ –ó–ê–ú–ï–ù–´ –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô

## üìã –ü—Ä–æ–±–ª–µ–º—ã –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Ä–µ—à–µ–Ω—ã

### 1. üñºÔ∏è Headshot —Ä–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏–µ
**–ü—Ä–æ–±–ª–µ–º–∞**: Headshot –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞—Å—Ç—è–≥–∏–≤–∞–ª–∏—Å—å –∏ –≤—ã–≥–ª—è–¥–µ–ª–∏ –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–º–∏
- **–ü—Ä–∏—á–∏–Ω–∞**: `preserveAspectRatio="none"` –≤ SVG —à–∞–±–ª–æ–Ω–∞—Ö
- **–°–∏–º–ø—Ç–æ–º—ã**: –õ–∏—Ü–∞ –Ω–∞ headshot –≤—ã–≥–ª—è–¥–µ–ª–∏ —Å–∂–∞—Ç—ã–º–∏ –∏–ª–∏ —Ä–∞—Å—Ç—è–Ω—É—Ç—ã–º–∏

**–†–µ—à–µ–Ω–∏–µ**:
- –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—è (`headshot` –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω—è–µ–º `preserveAspectRatio` –Ω–∞ `"xMidYMid slice"`
- `slice` –æ–±—Ä–µ–∑–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏

### 2. üì∏ Photo —Å–ª–∞–π–¥ –Ω–µ –∑–∞–º–µ–Ω—è–ª—Å—è
**–ü—Ä–æ–±–ª–µ–º–∞**: `dyno.propertyimage2` –≤ photo.svg –Ω–µ –∑–∞–º–µ–Ω—è–ª—Å—è
- **–ü—Ä–∏—á–∏–Ω–∞**: –≠–ª–µ–º–µ–Ω—Ç –±—ã–ª –≥—Ä—É–ø–ø–æ–π `<g>`, –∞ –Ω–µ –ø—Ä—è–º—ã–º `<image>`
- **–°–∏–º–ø—Ç–æ–º—ã**: –í –ª–æ–≥–∞—Ö `‚ö†Ô∏è –≠–ª–µ–º–µ–Ω—Ç dyno.propertyimage2 –Ω–∞–π–¥–µ–Ω, –Ω–æ –Ω–µ –∏–º–µ–µ—Ç fill —Å pattern`

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω –ø–æ–∏—Å–∫ –≥—Ä—É–ø–ø `<g id="dyno.propertyimage2">`
- –ü–æ–∏—Å–∫ `fill="url(#pattern_id)"` –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã
- –¶–µ–ø–æ—á–∫–∞: –≥—Ä—É–ø–ø–∞ ‚Üí pattern ‚Üí use ‚Üí image

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ

### `preview_system.py` - —Ñ—É–Ω–∫—Ü–∏—è `replace_image_in_svg()`

#### –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
```python
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ aspect ratio
if 'headshot' in field_name.lower():
    image_type = 'headshot'
    aspect_ratio = 'xMidYMid slice'  # –ò–°–ü–†–ê–í–õ–ï–ù–û: slice –≤–º–µ—Å—Ç–æ meet
elif 'property' in field_name.lower():
    image_type = 'property'
    aspect_ratio = 'xMidYMid slice'
else:
    image_type = 'other'
    aspect_ratio = 'xMidYMid meet'
```

#### –î–æ–±–∞–≤–ª–µ–Ω –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—ã:
```python
# –ú–µ—Ç–æ–¥ 2: –ù–û–í–û–ï - –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—É (–¥–ª—è photo.svg)
group_pattern = rf'<g[^>]*id="[^"]*{re.escape(field_name)}[^"]*"[^>]*>'
group_match = re.search(group_pattern, svg_content, re.IGNORECASE)

if group_match:
    # –ù–∞—Ö–æ–¥–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≥—Ä—É–ø–ø—ã
    # –ò—â–µ–º fill="url(#pattern_id)" –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã
    # –ó–∞–º–µ–Ω—è–µ–º —á–µ—Ä–µ–∑ pattern ‚Üí use ‚Üí image
```

#### –î–æ–±–∞–≤–ª–µ–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ aspect ratio:
```python
# –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø—Ä–∞–≤–ª—è–µ–º aspect ratio –µ—Å–ª–∏ —ç—Ç–æ headshot
if image_type == 'headshot':
    aspect_pattern = rf'(<image[^>]*id="{re.escape(image_id)}"[^>]*preserveAspectRatio=")[^"]*("[^>]*>)'
    new_svg = re.sub(aspect_pattern,
                    lambda m: m.group(1) + aspect_ratio + m.group(2),
                    new_svg)
    print(f"üîß Aspect ratio –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞: {aspect_ratio}")
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã:
1. `test_fixes_simple.py` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. `quick_fix_test.py` - –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –∑–∞–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
3. `test_server_fixes.py` - —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ API —Å–µ—Ä–≤–µ—Ä–∞

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:
```
‚úÖ Headshot: aspect ratio 'none' ‚Üí 'xMidYMid slice'
‚úÖ Photo: –≥—Ä—É–ø–ø–∞ dyno.propertyimage2 ‚Üí pattern0_332_4 ‚Üí image0_332_4
‚úÖ –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚ùå Headshot —Ä–∞—Å—Ç—è–≥–∏–≤–∞–ª—Å—è –∏ –≤—ã–≥–ª—è–¥–µ–ª –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–º
- ‚ùå Photo —Å–ª–∞–π–¥ –ø–æ–∫–∞–∑—ã–≤–∞–ª –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- ‚ùå –í –ª–æ–≥–∞—Ö: `‚ö†Ô∏è –≠–ª–µ–º–µ–Ω—Ç dyno.propertyimage2 –Ω–∞–π–¥–µ–Ω, –Ω–æ –Ω–µ –∏–º–µ–µ—Ç fill —Å pattern`

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ Headshot –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫—Ä–æ–ø–∞–µ—Ç—Å—è –±–µ–∑ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏—è
- ‚úÖ Photo —Å–ª–∞–π–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ –í –ª–æ–≥–∞—Ö: `‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–º–µ–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ pattern!`

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã SVG

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

1. **–ü—Ä—è–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã**: `<image id="dyno.field" href="..."/>`
2. **Pattern —ç–ª–µ–º–µ–Ω—Ç—ã**: `<rect id="dyno.field" fill="url(#pattern_id)"/>`
3. **–ì—Ä—É–ø–ø—ã**: `<g id="dyno.field"><rect fill="url(#pattern_id)"/></g>`

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä**: `python3 app.py`
2. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ** —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ API
3. **–ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—Ä–µ–≤—å—é** –±–µ–∑ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:
```json
{
  "dyno.agentheadshot": "https://example.com/headshot.jpg",
  "dyno.propertyimage2": "https://example.com/property.jpg",
  "dyno.logo": "https://example.com/logo.png"
}
```

## üîÑ –ö–æ–º–º–∏—Ç—ã

- `5b8b8b8`: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `67dc7e6`: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø: Headshot aspect ratio –∏ Photo –≥—Ä—É–ø–ø—ã

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å**: üöÄ –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£